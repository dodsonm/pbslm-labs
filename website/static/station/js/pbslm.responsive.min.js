PBSLM=window.PBSLM||{},function(){"use strict";this.scrollWindow=function(a){"down"==a?(this.pos=$(window).scrollTop(),$("html,body").scrollTop(0)):$("html,body").scrollTop(this.pos||0)},this.toggleElement=function(a,b,c,d){c=c||250,d=d||400;var e=$(a).data(),f=e.target;$(f).hasClass("js-open")?b?($(f).removeClass("js-open"),$(a).removeClass("js-open")):$(f).slideUp({duration:c,start:function(){$(this).removeClass("js-open"),$(a).removeClass("js-open")}}):b?($(f).addClass("js-open"),$(a).addClass("js-open")):$(f).slideDown({duration:d,complete:function(){$(this).addClass("js-open"),$(a).addClass("js-open")}})},this.switchPage=function(a){var b=$(a).data(),c=b.target,d=b.resizetarget,e=this;$(c).hasClass("is-active")||($(c).addClass("is-active").siblings().removeClass("is-active"),d?e.resizeScreenToTarget(d):$("html, body").removeAttr("style"))},this.resetPage=function(){var a=$(".default-page");$(a).hasClass("is-active")||($(a).addClass("is-active").siblings().removeClass("is-active"),$("html, body").removeAttr("style"))},this.doResize=function(){var a=$(window).width(),b=this;if(b.currentViewPort=a,b.hasMultiMedia=b.hasMultiMedia||$("#media-playlist"),b.hasMultiMedia&&b.mediaItems.pgResize(),b.debugMode===!0){var c="Panda-UX @ "+a+"px";document.title=c}PBSLM.resetPage(),a>759?($("#mainNavigation").show().removeClass("js-open"),$("#searchbar").removeAttr("style"),$("#mainNavigation").find(".open").removeClass("js-open")):($("#mainNavigation").hide(),PBSLM.jwp&&PBSLM.jwp.stop())},this.getMediaItemInfo=function(a){var b=$(a);return[{target:"#featured-title",value:b.find(".media-item-xs .media-open-text").text()},{target:"#featured-body",value:b.find(".media-item-text").text()},{target:"#info-permitted-use",value:b.find(".info-permitted-use").text()},{target:"#info-accessibility",value:b.find(".info-accessibility").text()},{target:"#featured-img",value:b.find(".media-item-img").attr("src"),changeType:"attr",attr:"src"},{target:"#option-transcript",value:b.find(".info-transcript a").attr("href"),changeType:"attr",attr:"href"},{target:"#option-transcript",value:b.find(".info-transcript a").attr("href")?"":"display: none;",changeType:"attr",attr:"style"},{target:"#option-download",value:b.find(".info-download").attr("data-download")?"":"display:none;",changeType:"attr",attr:"style"},{target:"#download_form",value:b.find(".info-download").attr("data-download")?"":"display:none;",changeType:"attr",attr:"style"},{target:"#download_form",value:b.find(".info-download").attr("data-download"),changeType:"attr",attr:"action"},{target:"#download_licence",value:b.find(".info-download").attr("data-licence"),changeType:"attr",attr:"href"}]},this.updateElem=function(a){a.changeType?"attr"===a.changeType?$(a.target).attr(a.attr,a.value):$(a.target).html(a.value):$(a.target).text(a.value)},this.mediaItems=function(a){return{$listElem:function(){return $("#media-playlist-wrapper")}(),$itemElem:function(){return $(".media-selected")}(),totalItems:function(){return $(".media-item").length}(),itemsPerPg:function(){return a.currentViewPort>1260?3:2},itemHeight:function(){return this.$itemElem.height()},pgHeight:function(){return this.itemsPerPg()*this.itemHeight()},currentPg:function(a){return a?this.pg=a:this.pg||1},totalPgs:function(){return Math.ceil(this.totalItems/this.itemsPerPg())},pgDown:function(){var a=this.currentPg();return a+1<=this.totalPgs()?this.currentPg(++a):!1},pgUp:function(){var a=this.currentPg();return a-1>0?this.currentPg(--a):!1},ctrlUpdate:function(){var b=this.currentPg()+"/"+this.totalPgs();a.updateElem({target:"#playlist-count",value:b})},scrollPg:function(a){this.$listElem.animate({top:-1*a},this.ctrlUpdate(this.currentPg(),this.totalPgs()))},changePg:function(a){var b=0;"down"==a&&this.pgDown()?b=2:"up"==a&&this.pgUp()&&(b=-2),this.scrollPg((this.currentPg()-1)*this.pgHeight()+b)},pgResize:function(){this.currentPg()>this.totalPgs()?this.changePg("up"):this.scrollPg((this.currentPg()-1)*this.pgHeight()+2),this.ctrlUpdate()}}}(this),this.resizeScreenToTarget=function(a){a=a||"default";if("default"===a||$(a).hasClass("default-page"))$("html, body").removeAttr("style");else{var b=$(window).height(),c=$(a).offset().top,d=$(a).outerHeight(),e=c+d;e>b&&($(a).css({height:b,overflow:"scroll-y"}),b=e),$("html,body").css({height:b,overflow:"hidden"})}}}.apply(PBSLM),$(document).ready(function(){Modernizr.svg||$('img[src$=".svg"]').each(function(){$(this).attr("src",$(this).attr("src").replace(".svg",".png"))}),$(window).smartresize(function(){PBSLM.doResize()}),$("#owl-slider").owlCarousel({paginationSpeed:800,singleItem:!0,autoPlay:1e4,stopOnHover:!1,navigation:!0,navigationText:["K","J"]}),$("#carouselOne__nav").remove(),$(".browse-grade, .browse-options").on("click touchstart",function(a){var b=$(".search-form-filters"),c=$(".lm-triangle-toggle",$(this));a.preventDefault(),b.hasClass("is-open")?(b.slideUp(),b.removeClass("is-open"),c.removeClass("lm-triangle-up").addClass("lm-triangle-down")):(b.slideDown(),b.addClass("is-open"),c.removeClass("lm-triangle-down").addClass("lm-triangle-up"))}),$(document).on("click touchstart",".nav-btn, .navbar-toggle, .lesson-open, .coll-show-hide, .help-show-hide, .toggle-facet-container",function(a){a.preventDefault();var b="topics-title"==this.id;PBSLM.toggleElement(this,b)}),$(".media-open-text").on("click touchstart",function(a){return PBSLM.currentViewPort>768?!1:(a.preventDefault(),void PBSLM.toggleElement(this,!0))}),$(".media-close-text").on("click touchstart",function(a){a.preventDefault();var b=$(this).parent().parent().find(".media-open-text");$(b).trigger("click")}),$("#media-playlist").on("click touchstart",".media-item",function(a){var b=$(".media-item").index(this);PBSLM.currentViewPort<768||$(this).hasClass("media-selected")||($(a.target).hasClass("playlist-item-link")&&PBSLM.currentViewPort>768&&a.preventDefault(),$(this).siblings().removeClass("media-selected"),$(this).addClass("media-selected"),$.each(PBSLM.getMediaItemInfo(this),function(a,b){PBSLM.updateElem(b)}),PBSLM.jwp&&PBSLM.jwp.playlistItem(b))}),$("#playlist-down").on("click touchstart",function(a){a.preventDefault(),PBSLM.mediaItems.changePg("down")}),$("#playlist-up").on("click touchstart",function(a){a.preventDefault(),PBSLM.mediaItems.changePg("up")}),$(".lesson-min").on("click touchstart",function(){$(".lesson-open").trigger("click")}),$("#video-info").on("click touchstart",function(a){var b=$(window).width(),c=769>b;a.preventDefault(),a.stopPropagation(),$(this).hasClass("btn-open")?c&&$("#page-info").is(":hidden")?($(this).addClass("btn-active"),$("#page-info").slideDown()):($("#page-info").slideUp(),$(this).removeClass("btn-open btn-active"),$(this).addClass("btn-closed")):($(this).hasClass("btn-closed")&&(c,$("#page-info").slideDown()),$(this).removeClass("btn-closed"),$(this).addClass("btn-open btn-active"))}),$("#play-video").on("click",function(){PBSLM.jwp.play()}),$("#social-info").on("click touchstart",function(a){a.preventDefault(),$(this).hasClass("btn-open")?($(".social-btns").slideUp(),$(this).removeClass("btn-open btn-active"),$(this).addClass("btn-closed")):($(this).removeClass("btn-closed"),$(this).addClass("btn-open btn-active"),$(".social-btns").slideDown())}),$(".hide-images-toggle").on("click touchstart",function(){var a=$("#search-results-container"),b=$(".hide-images-toggle"),c=this,d=$(this).prop("checked");$(this).is(":checked")?a.addClass("hide-images"):a.removeClass("hide-images"),b.each(function(){c.id!=this.id&&$(this).prop("checked",d)})}),$(".toggle").click(function(a){a.preventDefault();var b=this;PBSLM.toggleElement(b),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")}),$("#coll-pg-toggle").on("click touchstart",function(a){var b=$(".pg-shown"),c=$(".pg-hidden");a.preventDefault(),b.each(function(){$(this).addClass("pg-hidden").removeClass("pg-shown")}),c.each(function(){$(this).addClass("pg-shown").removeClass("pg-hidden")})}),$(".scroll-to").on("click",function(a){a.preventDefault();var b=$(this).data(),c=b.target,d=$(c).offset(),e=d.top-$(".site-header").height();return $("html, body").animate({scrollTop:e},"slow"),$(c).find('input[type="search"]').focus(),!1}),PBSLM.doResize(),$(".brand-img").hover(function(){var a=$(this),b=a.data("color");a.attr("src",b),a.animate({opacity:.5},{complete:function(){a.animate({opacity:1})}})},function(){var a=$(this),b=a.data("grayscale");a.attr("src",b)}),$(".lm-favorite-this").on("click touchstart",function(){var a=$(this);fav_url=a.attr("1"==a.attr("data-is-fav")?"data-unfav-url":"data-fav-url"),$.ajax({url:fav_url,success:function(){"1"==a.attr("data-is-fav")?(a.attr("data-is-fav","0"),$("i",a).removeClass("lm-star").addClass("lm-heart")):(a.attr("data-is-fav","1"),$("i",a).removeClass("lm-heart").addClass("lm-star"))}})}),$(".lm-star-outline").click(function(){var a=$(".lm-star-outline"),b=a.index(this)+1,c=a.filter(".selected"),d=$(this).data("rate-id");b==c.length?$(this).hasClass("selected")&&(b=0):($(this).addClass("selected").nextAll().removeClass("selected"),$(this).prevAll().addClass("selected")),0!=b&&$.post("/rate_it/"+d+"/",{rating:b})})}),function(a,b){var c=function(a,b,c){var d;return function(){function e(){c||a.apply(f,g),d=null}var f=this,g=arguments;d?clearTimeout(d):c&&a.apply(f,g),d=setTimeout(e,b||100)}};jQuery.fn[b]=function(a){return a?this.bind("resize",c(a)):this.trigger(b)}}(jQuery,"smartresize");